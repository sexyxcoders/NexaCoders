<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Encode • Decode — Minimal Futuristic</title>
<meta name="description" content="Client-side encoder/decoder (Base64, URL, Hex, ROT13, UTF-8, JS Hex). Clean minimal futuristic UI. Share encoded payload in the URL hash." />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap">
<style>
  :root{
    --bg: #f6f7fb;
    --panel: #ffffff;
    --muted: #6b7280;
    --text: #0f172a;
    --accent: #0f172a;
    --border: #e6e9ef;
    --glass: rgba(12,18,30,0.02);
    --radius: 12px;
    --mono: "ui-monospace", "SFMono-Regular", "Menlo", "Monaco", "Roboto Mono", monospace;
  }

  /* Base */
  html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:linear-gradient(180deg,var(--bg),#eef1f7); color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  .app{max-width:1100px;margin:36px auto;padding:28px;box-sizing:border-box;}
  header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:20px;}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,#111827,#0b1220);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:18px}
  h1{margin:0;font-size:18px;letter-spacing:0.2px}
  .sub{color:var(--muted);font-size:13px;margin-top:2px}

  /* layout */
  .board{display:grid;grid-template-columns:300px 1fr;gap:18px;}
  @media (max-width:920px){ .board{grid-template-columns:1fr} .left-hide{display:none} }

  /* panel */
  .panel{background:var(--panel);border-radius:var(--radius);padding:16px;border:1px solid var(--border);box-shadow:0 6px 20px rgba(16,24,40,0.04)}
  .panel .title{font-weight:700;color:var(--accent)}

  /* sidebar */
  .modes{display:flex;gap:8px;margin-top:10px}
  .mode-btn{flex:1;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:transparent;font-weight:600;color:var(--muted);cursor:pointer}
  .mode-btn.active{background:linear-gradient(180deg,#f1f5f9,#eef2ff); color:var(--accent); border-color:#dbeafe}
  .methods{display:flex;flex-direction:column;gap:8px;margin-top:12px}
  .method-btn{display:block;text-align:left;padding:10px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;font-weight:600}
  .method-btn small{display:block;font-weight:400;color:var(--muted);font-size:12px;margin-top:4px}
  .method-btn.active{background:linear-gradient(180deg,#fbfdff,#f6f9ff);color:var(--accent);border-color:#e2e8ff;box-shadow:0 6px 12px rgba(14,165,233,0.03)}

  .sidebar-row{display:flex;gap:8px;margin-top:12px}
  .btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:transparent;cursor:pointer;font-weight:600;color:var(--muted)}
  .btn.primary{background:#0f172a;color:#fff;border:none;box-shadow:0 8px 24px rgba(15,23,42,0.08)}
  .pill{font-size:12px;padding:6px 10px;border-radius:999px;background:var(--glass);border:1px solid var(--border);color:var(--muted)}

  /* editor area */
  .editor-grid{display:grid;grid-template-columns:1fr 220px;gap:12px}
  @media (max-width:920px){ .editor-grid{grid-template-columns:1fr} }
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}
  textarea{width:100%;min-height:220px;padding:14px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(180deg,#ffffff,#fbfdff);font-family:var(--mono);font-size:14px;color:var(--text);outline:none;resize:vertical;box-sizing:border-box}
  textarea[readonly]{background:#fafbff}
  .meta{padding:10px;border-radius:10px;border:1px solid var(--border);background:transparent;font-weight:700;color:var(--accent);text-align:center}
  .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;align-items:center}

  /* output actions */
  .out-actions{display:flex;gap:8px;align-items:center;margin-top:10px}
  .muted{color:var(--muted);font-size:13px}

  /* footer */
  .footer{text-align:center;color:var(--muted);font-size:13px;margin-top:14px}

  /* small helpers */
  .error{color:#dc2626;font-size:13px;margin-top:8px;display:none}
  .toast{position:fixed;right:20px;bottom:24px;background:#0f172a;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 10px 30px rgba(15,23,42,0.12);opacity:0;transform:translateY(8px);transition:all .22s;pointer-events:none}
  .toast.show{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">ED</div>
        <div>
          <h1>Encode • Decode</h1>
          <div class="sub">Base64, URL, Hex, ROT13, UTF-8, JS Hex — client-side transforms & shareable links</div>
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <div class="pill">Client-side</div>
        <button id="runTop" class="btn">Run</button>
      </div>
    </header>

    <main class="board">
      <!-- SIDEBAR -->
      <aside class="panel left-hide">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="title">Mode</div>
          <div id="selectedMethodLabel" style="color:var(--muted);font-weight:700">Base64</div>
        </div>

        <div class="modes">
          <button id="modeEncode" class="mode-btn active">Encode</button>
          <button id="modeDecode" class="mode-btn">Decode</button>
        </div>

        <div class="methods" aria-hidden="false">
          <button class="method-btn active" data-method="base64"><span>Base64</span><small>Unicode-safe Base64</small></button>
          <button class="method-btn" data-method="url"><span>URL</span><small>Percent encoding</small></button>
          <button class="method-btn" data-method="hex"><span>Hex</span><small>Hexadecimal bytes</small></button>
          <button class="method-btn" data-method="rot13"><span>ROT13</span><small>Simple substitution</small></button>
          <button class="method-btn" data-method="utf8"><span>UTF-8</span><small>Bytes view (space separated)</small></button>
          <button class="method-btn" data-method="jshex"><span>JS Hex</span><small>"\xNN" escape bytes</small></button>
        </div>

        <div class="sidebar-row">
          <button id="clearAll" class="btn">Clear</button>
          <button id="swapBtn" class="btn">Swap</button>
        </div>

        <div style="margin-top:12px;color:var(--muted);font-size:13px">Tip: Use <strong>Share link</strong> to copy a short URL that decodes automatically in the app.</div>
        <div style="height:12px"></div>

        <div style="margin-top:12px">
          <div class="panel" style="padding:12px;background:transparent;border:none">
            <div style="font-weight:700;color:var(--accent)">Privacy</div>
            <div class="muted" style="margin-top:8px;font-size:13px">All transforms run in your browser. Links contain the encoded payload in the URL hash and never reach a server.</div>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <section>
        <div class="panel">
          <div style="display:flex;gap:12px;align-items:flex-start">
            <div style="flex:1;min-width:0">
              <label for="input">Input</label>
              <textarea id="input" placeholder="Paste text or code here — Unicode supported"></textarea>
            </div>

            <div style="width:220px;flex-shrink:0;display:flex;flex-direction:column;gap:10px">
              <div class="meta">
                <div style="font-size:13px;color:var(--muted)">Method</div>
                <div id="methodBadge" style="font-size:16px;margin-top:6px">Base64</div>
                <div id="methodHint" style="font-size:12px;color:var(--muted);margin-top:6px">Unicode-safe Base64</div>
              </div>
              <button id="runMain" class="btn primary">Run</button>
              <button id="insertExample" class="btn">Insert example</button>
            </div>
          </div>

          <div id="error" class="error" role="alert"></div>
        </div>

        <div style="height:12px"></div>

        <div class="panel">
          <label for="output">Output</label>
          <textarea id="output" readonly placeholder="Result appears here"></textarea>

          <div class="out-actions" style="margin-top:12px">
            <button id="copyOut" class="btn">Copy</button>
            <button id="downloadOut" class="btn">Download</button>
            <button id="shareOut" class="btn">Share link</button>
            <div style="flex:1"></div>
            <div class="muted">Export: plain text</div>
          </div>
        </div>

        <div class="footer">Made with ❤️ — fully client-side. Consider AES for secure messages.</div>
      </section>
    </main>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
/* ---------- Helpers (Unicode-safe) ---------- */
function utf8ToBase64(str){
  const enc = new TextEncoder();
  const bytes = enc.encode(str);
  let binary = '';
  for(let i=0;i<bytes.length;i++) binary += String.fromCharCode(bytes[i]);
  return btoa(binary);
}
function base64ToUtf8(b64){
  try{
    const binary = atob(b64);
    const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
    const dec = new TextDecoder();
    return dec.decode(bytes);
  }catch(e){
    return null;
  }
}

/* Hex */
function encodeHex(str){
  const enc = new TextEncoder(); const bytes = enc.encode(str);
  return Array.from(bytes).map(b => b.toString(16).padStart(2,'0')).join('');
}
function decodeHex(hex){
  try{
    const clean = hex.trim().replace(/\s+/g,'');
    if(clean.length % 2) return null;
    const parts = clean.match(/.{1,2}/g);
    const bytes = new Uint8Array(parts.map(p => parseInt(p,16)));
    const dec = new TextDecoder();
    return dec.decode(bytes);
  }catch(e){ return null; }
}

/* ROT13 */
function rot13(str){
  return str.replace(/[A-Za-z]/g, c => { const base = c <= 'Z' ? 65 : 97; return String.fromCharCode(((c.charCodeAt(0)-base+13)%26)+base); });
}

/* UTF-8 bytes view */
function utf8EncodeBytes(str){
  const enc = new TextEncoder(); return Array.from(enc.encode(str)).join(' ');
}
function utf8DecodeBytes(listStr){
  const parts = listStr.trim().split(/\s+/).map(n=>Number(n));
  if(parts.some(n=>Number.isNaN(n) || n<0 || n>255)) return null;
  const dec = new TextDecoder(); return dec.decode(new Uint8Array(parts));
}

/* JS Hex: "\xNN" */
function encodeJsHex(str){
  const bytes = new TextEncoder().encode(str);
  return Array.from(bytes).map(b => '\\x' + b.toString(16).padStart(2,'0')).join('');
}
function decodeJsHex(str){
  try{
    // Accept variations: \xNN or 0xNN or spaced hex bytes
    // Replace 0xNN with \xNN
    const unify = str.replace(/0x([0-9a-fA-F]{2})/g,'\\x$1');
    // Now convert all \xNN sequences to raw characters, but leave other chars intact
    const decoded = unify.replace(/\\x([0-9a-fA-F]{2})/g, (_,h) => String.fromCharCode(parseInt(h,16)));
    // If result still contains literal "\x", but no valid pairs, it's likely invalid input — we still return string.
    return decoded;
  }catch(e){ return null; }
}

/* URL-safe base64 helpers for share links */
function toUrlSafeBase64(b64){ return b64.replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,''); }
function urlSafeToBase64(s){
  if(!s) return null;
  let out = s.replace(/-/g,'+').replace(/_/g,'/');
  while(out.length % 4) out += '=';
  return out;
}

/* ---------- UI elements ---------- */
const inputEl = document.getElementById('input');
const outputEl = document.getElementById('output');
const runMain = document.getElementById('runMain');
const runTop = document.getElementById('runTop');
const copyOut = document.getElementById('copyOut');
const downloadOut = document.getElementById('downloadOut');
const shareOut = document.getElementById('shareOut');
const toast = document.getElementById('toast');
const errorEl = document.getElementById('error');
const modeEncode = document.getElementById('modeEncode');
const modeDecode = document.getElementById('modeDecode');
const selectedMethodLabel = document.getElementById('selectedMethodLabel');
const methodBadge = document.getElementById('methodBadge');
const methodHint = document.getElementById('methodHint');
const clearAll = document.getElementById('clearAll');
const swapBtn = document.getElementById('swapBtn');
const insertExample = document.getElementById('insertExample');

let mode = 'encode';
let method = 'base64';

/* ---------- Methods metadata ---------- */
const METHODS = {
  base64:{label:'Base64', hint:'Unicode-safe Base64'},
  url:{label:'URL', hint:'Percent-encoding'},
  hex:{label:'Hex', hint:'Hexadecimal bytes'},
  rot13:{label:'ROT13', hint:'Simple substitution cipher'},
  utf8:{label:'UTF-8', hint:'Bytes view (space separated)'},
  jshex:{label:'JS Hex', hint:'"\\xNN" escape bytes'}
};

/* ---------- attach event to method buttons ---------- */
document.querySelectorAll('.method-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.method-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    method = btn.getAttribute('data-method');
    selectedMethodLabel.textContent = METHODS[method].label;
    methodBadge.textContent = METHODS[method].label;
    methodHint.textContent = METHODS[method].hint;
  });
});

/* ---------- mode toggles ---------- */
modeEncode.addEventListener('click', ()=>{ mode = 'encode'; modeEncode.classList.add('active'); modeDecode.classList.remove('active'); });
modeDecode.addEventListener('click', ()=>{ mode = 'decode'; modeDecode.classList.add('active'); modeEncode.classList.remove('active'); });

/* ---------- small UI helpers ---------- */
function showToast(msg, time=1800){
  toast.textContent = msg; toast.classList.add('show');
  setTimeout(()=>toast.classList.remove('show'), time);
}
function showError(msg){
  errorEl.style.display = 'block'; errorEl.textContent = msg;
  setTimeout(()=>{ errorEl.style.display='none'; }, 3600);
}

/* ---------- run logic ---------- */
function runTransform(){
  errorEl.style.display = 'none';
  let inText = inputEl.value || '';
  try{
    let res = '';
    if(method === 'base64'){
      if(mode === 'encode') res = utf8ToBase64(inText);
      else {
        const dec = base64ToUtf8(inText.trim());
        if(dec === null) throw new Error('Invalid Base64 input');
        res = dec;
      }
    } else if(method === 'url'){
      if(mode === 'encode') res = encodeURIComponent(inText);
      else {
        try{ res = decodeURIComponent(inText); } catch(e){ throw new Error('Invalid URL-encoded input'); }
      }
    } else if(method === 'hex'){
      if(mode === 'encode') res = encodeHex(inText);
      else {
        const dec = decodeHex(inText);
        if(dec === null) throw new Error('Invalid Hex input');
        res = dec;
      }
    } else if(method === 'rot13'){
      res = rot13(inText);
    } else if(method === 'utf8'){
      if(mode === 'encode'){
        res = utf8EncodeBytes(inText);
      } else {
        const dec = utf8DecodeBytes(inText);
        if(dec === null) throw new Error('Invalid byte list');
        res = dec;
      }
    } else if(method === 'jshex'){
      if(mode === 'encode') res = encodeJsHex(inText);
      else {
        const dec = decodeJsHex(inText);
        if(dec === null) throw new Error('Invalid JS Hex input');
        res = dec;
      }
    } else {
      throw new Error('Unknown method');
    }

    outputEl.value = res;
    showToast('Done');
  }catch(e){
    showError('Error: ' + (e.message || 'Invalid input'));
    outputEl.value = '';
  }
}

/* ---------- share helpers ---------- */
function makeShareLink(payloadText){
  // payloadText -> utf8 base64 -> url-safe base64 -> #msg=...
  const b64 = utf8ToBase64(payloadText);
  const safe = toUrlSafeBase64(b64);
  return location.origin + location.pathname + '#msg=' + safe;
}
function readShareFromHash(){
  const hash = location.hash.slice(1);
  if(!hash) return null;
  const params = new URLSearchParams(hash);
  const v = params.get('msg');
  if(!v) return null;
  const padded = urlSafeToBase64(v);
  if(!padded) return null;
  return base64ToUtf8(padded);
}

/* ---------- button bindings ---------- */
runMain.addEventListener('click', runTransform);
runTop.addEventListener('click', runTransform);

copyOut.addEventListener('click', async ()=> {
  try{ await navigator.clipboard.writeText(outputEl.value || ''); showToast('Copied'); }
  catch(e){ showError('Cannot copy to clipboard'); }
});
downloadOut.addEventListener('click', ()=> {
  const blob = new Blob([outputEl.value || ''], {type:'text/plain'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'output.txt'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});
shareOut.addEventListener('click', async ()=> {
  const payload = outputEl.value || inputEl.value || '';
  if(!payload){ showError('Nothing to share'); return; }
  const link = makeShareLink(payload);
  try{ await navigator.clipboard.writeText(link); showToast('Share link copied'); }
  catch(e){ showError('Could not copy link'); }
});

/* extra controls */
clearAll.addEventListener('click', ()=>{ inputEl.value=''; outputEl.value=''; showToast('Cleared') });
swapBtn.addEventListener('click', ()=>{ inputEl.value = outputEl.value || ''; outputEl.value=''; showToast('Swapped'); });
insertExample.addEventListener('click', ()=>{ inputEl.value = 'Hello from Minimal Futuristic!\\nThis is an example message.'; showToast('Example inserted'); });

/* keyboard shortcut: Ctrl+Enter to run */
document.addEventListener('keydown', (e)=>{ if((e.ctrlKey||e.metaKey) && e.key === 'Enter'){ runTransform(); } });

/* ---------- Load from hash if present ---------- */
(function initFromHash(){
  try{
    const maybe = readShareFromHash();
    if(maybe !== null){
      inputEl.value = maybe;
      mode = 'decode';
      modeEncode.classList.remove('active'); modeDecode.classList.add('active');
      showToast('Shared message loaded — set to Decode');
    }
  }catch(e){ /* ignore */ }
})();

/* fallback: query param */
(function tryQueryFallback(){
  const q = new URLSearchParams(location.search).get('msg');
  if(q && !location.hash) {
    location.hash = 'msg=' + q;
    try{ const m = readShareFromHash(); if(m){ inputEl.value = m; mode = 'decode'; modeEncode.classList.remove('active'); modeDecode.classList.add('active'); showToast('Shared message loaded — set to Decode'); } } catch(e){}
  }
})();
</script>
</body>
</html>